schema="EIMTRD";
query="SELECT
	 TC_NAME,
	 TC_RESULT,
	 EXEC_USER,
	 CYC_NAME,
	 START_TIME,
	 END_TIME,
	 TO_VARCHAR(EXEC_TS) AS SCH_DATE,
	 EXEC_TIME,
	 BUG_ID,
	 PRO_NAME,
	 PRO_VER,
	 PRO_VER_STR,
	 PLAT_NAME,
	 OS_NAME,
	 HOST_NAME
FROM EIMTRD.ETRD_TEST_RESULTS 

INNER JOIN
        (   SELECT  TC_NAME AS TESTCASE,
        	EXEC_USER AS TESTER,
        	MAX(EXEC_TS) AS SCH_DATE
            FROM EIMTRD.ETRD_TEST_RESULTS
            GROUP BY TC_NAME, EXEC_USER, PRO_VER
        ) AS MAX_SCH_DATE
            ON MAX_SCH_DATE.TESTCASE = ETRD_TEST_RESULTS.TC_NAME
            AND MAX_SCH_DATE.TESTER = ETRD_TEST_RESULTS.EXEC_USER
            AND MAX_SCH_DATE.SCH_DATE = ETRD_TEST_RESULTS.EXEC_TS

ORDER BY TC_NAME, SCH_DATE DESC";

